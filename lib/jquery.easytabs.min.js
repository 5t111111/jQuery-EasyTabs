(function(b){function a(f,c,e){var d=b.Event(c);f.trigger(d,e);return d.result!==false}b.easytabs=function(c,m){var g={animate:true,panelActiveClass:"active",tabActiveClass:"active",defaultTab:"li:first-child",animationSpeed:"normal",tabs:"> ul > li",updateHash:true,cycle:false,collapsible:false,collapsedClass:"collapsed",collapsedByDefault:true,uiTabs:false,transitionIn:"fadeIn",transitionOut:"fadeOut",transitionCollapse:"slideUp",transitionUncollapse:"slideDown",containerClass:"",tabsClass:"",tabClass:"",panelClass:"",cache:true},i=this,l=b(c),e,h,k,d,j={fast:200,normal:400,slow:600},f;i.init=function(){i.settings=f=b.extend({},g,m);if(f.uiTabs){f.tabActiveClass="ui-tabs-selected";f.containerClass="ui-tabs ui-widget ui-widget-content ui-corner-all";f.tabsClass="ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all";f.tabClass="ui-state-default ui-corner-top";f.panelClass="ui-tabs-panel ui-widget-content ui-corner-bottom"}if(f.collapsible&&m.defaultTab!==undefined&&m.collpasedByDefault===undefined){f.collapsedByDefault=false}if(typeof(f.animationSpeed)==="string"){f.animationSpeed=j[f.animationSpeed]}b("a.anchor").remove().prependTo("body");l.data("easytabs",{});i.setTransitions();i.getTabs();i.addClasses();i.setDefaultTab();i.bindToTabClicks();i.initHashChange();i.initCycle();l.attr("data-easytabs",true)};i.setTransitions=function(){k=(f.animate)?{show:f.transitionIn,hide:f.transitionOut,speed:f.animationSpeed,collapse:f.transitionCollapse,uncollapse:f.transitionUncollapse,halfSpeed:f.animationSpeed/2}:{show:"show",hide:"hide",speed:0,collapse:"hide",uncollapse:"show",halfSpeed:0}};i.bindToTabClicks=function(){i.tabs.children("a").bind("click.easytabs",function(n){f.cycle=false;d=false;i.selectTab(b(this));n.preventDefault()})};i.getTabs=function(){var n;i.tabs=l.find(f.tabs),i.panels=b(),i.tabs.each(function(){var q=b(this),p=q.children("a"),o=q.children("a").data("target");q.data("easytabs",{});if(o!==undefined&&o!==null){q.data("easytabs").ajax=p.attr("href")}else{o=p.attr("href")}o=o.match(/#([^\?]+)/)[0].substr(1);n=l.find("#"+o);if(n.length){n.data("easytabs",{position:n.css("position"),visibility:n.css("visibility")});i.panels=i.panels.add(n.hide());q.data("easytabs").panel=n}else{i.tabs=i.tabs.not(q)}})};i.addClasses=function(){l.addClass(f.containerClass);i.tabs.parent().addClass(f.tabsClass);i.tabs.addClass(f.tabClass);i.panels.addClass(f.panelClass)};i.setDefaultTab=function(){var o=window.location.hash.match(/^[^\?]*/)[0],n=i.matchTab(o).parent(),p;if(n.length===1){e=n;f.cycle=false}else{p=i.matchInPanel(o);if(p.length){o="#"+p.attr("id");e=i.matchTab(o).parent()}else{e=i.tabs.parent().find(f.defaultTab);if(e.length===0){b.error("The specified default tab ('"+f.defaultTab+"') could not be found in the tab set.")}}}h=e.children("a").first();i.activateDefaultTab(n)};i.activateDefaultTab=function(p){var o,n;if(f.collapsible&&p.length===0&&f.collapsedByDefault){e.addClass(f.collapsedClass).children().addClass(f.collapsedClass)}else{o=b(e.data("easytabs").panel);n=e.data("easytabs").ajax;if(n&&(!f.cache||!e.data("easytabs").cached)){l.trigger("easytabs:ajax:beforeSend",[h,o]);o.load(n,function(r,q,s){e.data("easytabs").cached=true;l.trigger("easytabs:ajax:complete",[h,o,r,q,s])})}e.data("easytabs").panel.show().addClass(f.panelActiveClass);e.addClass(f.tabActiveClass).children().addClass(f.tabActiveClass)}};i.getHeightForHidden=function(o){if(o.data("easytabs")&&o.data("easytabs").lastHeight){return o.data("easytabs").lastHeight}var p=o.css("display"),n=o.wrap(b("<div>",{position:"absolute",visibility:"hidden",overflow:"hidden"})).css({position:"relative",visibility:"hidden",display:"block"}).outerHeight();o.unwrap();o.css({position:o.data("easytabs").position,visibility:o.data("easytabs").visibility,display:p});o.data("easytabs").lastHeight=n;return n};i.setAndReturnHeight=function(o){var n=o.outerHeight();if(o.data("easytabs")){o.data("easytabs").lastHeight=n}else{o.data("easytabs",{lastHeight:n})}return n};i.selectTab=function(n,s){var o=window.location,r=o.hash.match(/^[^\?]*/)[0],p=n.parent().data("easytabs").panel,q=n.parent().data("easytabs").ajax;if(f.collapsible&&!d&&(n.hasClass(f.tabActiveClass)||n.hasClass(f.collapsedClass))){i.toggleTabCollapse(n,p,q,s)}else{if(!n.hasClass(f.tabActiveClass)||!p.hasClass(f.panelActiveClass)){i.activateTab(n,p,q,s)}}};i.toggleTabCollapse=function(n,o,p,q){i.panels.stop(true,true);if(a(l,"easytabs:before",[n,o,f])){i.tabs.filter("."+f.tabActiveClass).removeClass(f.tabActiveClass).children().removeClass(f.tabActiveClass);if(n.hasClass(f.collapsedClass)){if(p&&(!f.cache||!n.parent().data("easytabs").cached)){l.trigger("easytabs:ajax:beforeSend",[n,o]);o.load(p,function(s,r,t){n.parent().data("easytabs").cached=true;l.trigger("easytabs:ajax:complete",[n,o,s,r,t])})}n.parent().removeClass(f.collapsedClass).addClass(f.tabActiveClass).children().removeClass(f.collapsedClass).addClass(f.tabActiveClass);o.addClass(f.panelActiveClass)[k.uncollapse](k.speed,function(){l.trigger("easytabs:midTransition",[n,o,f]);if(typeof q=="function"){q()}})}else{n.addClass(f.collapsedClass).parent().addClass(f.collapsedClass);o.removeClass(f.panelActiveClass)[k.collapse](k.speed,function(){l.trigger("easytabs:midTransition",[n,o,f]);if(typeof q=="function"){q()}})}}};i.activateTab=function(p,s,t,w){i.panels.stop(true,true);if(a(l,"easytabs:before",[p,s,f])){var q=i.panels.filter(":visible"),o=s.parent(),u,n,r,v;if(f.animate){u=i.getHeightForHidden(s);n=q.length?i.setAndReturnHeight(q):0;r=u-n}v=function(){l.trigger("easytabs:midTransition",[p,s,f]);if(f.animate&&f.transitionIn=="fadeIn"){if(r<0){o.animate({height:o.height()+r},k.halfSpeed).css({"min-height":""})}}if(f.updateHash&&!d){window.location.hash="#"+s.attr("id")}else{d=false}s[k.show](k.speed,function(){o.css({height:"","min-height":""});l.trigger("easytabs:after",[p,s,f]);if(typeof w=="function"){w()}})};if(t&&(!f.cache||!p.parent().data("easytabs").cached)){l.trigger("easytabs:ajax:beforeSend",[p,s]);s.load(t,function(y,x,z){p.parent().data("easytabs").cached=true;l.trigger("easytabs:ajax:complete",[p,s,y,x,z])})}if(f.animate&&f.transitionOut=="fadeOut"){if(r>0){o.animate({height:(o.height()+r)},k.halfSpeed)}else{o.css({"min-height":o.height()})}}i.tabs.filter("."+f.tabActiveClass).removeClass(f.tabActiveClass).children().removeClass(f.tabActiveClass);i.tabs.filter("."+f.collapsedClass).removeClass(f.collapsedClass).children().removeClass(f.collapsedClass);p.parent().addClass(f.tabActiveClass).children().addClass(f.tabActiveClass);i.panels.filter("."+f.panelActiveClass).removeClass(f.panelActiveClass);s.addClass(f.panelActiveClass);if(q.length){q[k.hide](k.speed,v)}else{s[k.uncollapse](k.speed,v)}}};i.matchTab=function(n){return i.tabs.find("[href='"+n+"'],[data-target='"+n+"']").first()};i.matchInPanel=function(n){return(n?i.panels.filter(":has("+n+")").first():[])};i.selectTabFromHashChange=function(){var o=window.location.hash.match(/^[^\?]*/)[0],n=i.matchTab(o),p;if(f.updateHash){if(n.length){d=true;i.selectTab(n)}else{p=i.matchInPanel(o);if(p.length){o="#"+p.attr("id");n=i.matchTab(o);d=true;i.selectTab(n)}else{if(!e.hasClass(f.tabActiveClass)&&!f.cycle){if(o===""||l.closest(o).length){d=true;i.selectTab(h)}}}}}};i.cycleTabs=function(n){if(f.cycle){n=n%i.tabs.length;$tab=b(i.tabs[n]).children("a").first();d=true;i.selectTab($tab,function(){setTimeout(function(){i.cycleTabs(n+1)},f.cycle)})}};i.initHashChange=function(){if(typeof b(window).hashchange==="function"){b(window).hashchange(function(){i.selectTabFromHashChange()})}else{if(b.address&&typeof b.address.change==="function"){b.address.change(function(){i.selectTabFromHashChange()})}}};i.initCycle=function(){var n;if(f.cycle){n=i.tabs.index(e);setTimeout(function(){i.cycleTabs(n+1)},f.cycle)}};i.publicMethods={select:function(n){var o;if((o=i.tabs.filter(n)).length===0){if((o=i.tabs.find("a[href='"+n+"']")).length===0){if((o=i.tabs.find("a"+n)).length===0){if((o=i.tabs.find("[data-target='"+n+"']")).length===0){b.error("Tab '"+n+"' does not exist in tab set")}}}}else{o=o.children("a").first()}i.selectTab(o)}};i.init()};b.fn.easytabs=function(d){var c=arguments;return this.each(function(){var f=b(this),e=f.data("easytabs");if(undefined===e){e=new b.easytabs(this,d);f.data("easytabs",e)}if(e.publicMethods[d]){return e.publicMethods[d](Array.prototype.slice.call(c,1))}})}})(jQuery);